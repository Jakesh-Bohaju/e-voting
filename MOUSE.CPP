
  /*************************************************************************
  **************************************************************************
  ******************************  Mouse.cpp  *******************************
  **************************************************************************
  *************************************************************************/

  /*************************************************************************

	  By :
		Muhammad Tahir Shahzad  [ MTS ]
		B.C.S Honours  [ 2000-04 ]
		Government College University Lahore
		Pakistan

      E-mail :  mtshome@wol.net.pk

    Web-Site :  www.mts-home.cjb.net  [ www.wol.net.pk/mtshome ]
		www.mtshome.cjb.net   [ www.geocities.com/mtahirshahzad ]

  *************************************************************************/

 /*************************************************************************/
 /*************************************************************************/
 //---------------------------  Header Files  ----------------------------//
 /*************************************************************************/
 /*************************************************************************/

 /*************************************************************************/
 //-----------------------------  Built-In  ------------------------------//
 /*************************************************************************/

 # include     <dos.h>
 # include   <stdio.h>
 # include   <conio.h>
 # include  <stdlib.h>

 /*************************************************************************/
 //---------------------------  User Defined  ----------------------------//
 /*************************************************************************/

 # include "Mouse.h"

 /*************************************************************************/
 /*************************************************************************/
 //--------------------------  Global Variables  -------------------------//
 /*************************************************************************/
 /*************************************************************************/

  union REGS InRegs;
  union REGS OutRegs;

  int prev_mouse_x=0;
  int prev_mouse_y=0;

 /*************************************************************************/
 /*************************************************************************/
 //----------------------  Mouse Function Definitions  -------------------//
 /*************************************************************************/
 /*************************************************************************/

 /*************************************************************************/
 //---------------------------  InitMouse( )  ----------------------------//
 /*************************************************************************/

 void InitMouse( )
    {
       InRegs.x.ax=0x0000;
       int86(0x33,&InRegs,&OutRegs);

       if(OutRegs.x.ax!=0xFFFF)
	  {
	     puts("\n\n\n\t *****  Error : Unable to detect the mouse driver  *****");
	     puts("\n\t  Press any key to exit and return.");

	     getch( );
	     exit(1);
	  }
    }

 /*************************************************************************/
 //---------------------------  ShowMouse( )  ----------------------------//
 /*************************************************************************/

 void ShowMouse( )
    {
       InRegs.x.ax=0x0001;
       int86(0x33,&InRegs,&OutRegs);
    }

 /*************************************************************************/
 //----------------------------  HideMouse( )  ---------------------------//
 /*************************************************************************/

 void HideMouse( )
    {
       InRegs.x.ax=0x02;
       int86(0x33,&InRegs,&OutRegs);
    }

 /*************************************************************************/
 //----------------------  SetMouseCoordinates( )  -----------------------//
 /*************************************************************************/

 void SetMouseCoordinates(const int x,const int y)
    {
       InRegs.x.ax=0x04;
       InRegs.x.cx=x;
       InRegs.x.dx=y;

       int86(0x33,&InRegs,&OutRegs);
    }

 /*************************************************************************/
 //---------------------------  RestrictMouse( )  ------------------------//
 /*************************************************************************/

 void RestrictMouse(const int x_min,const int y_min,
                                          const int x_max,const int y_max)
    {
	InRegs.x.ax=0x07;
	InRegs.x.cx=x_min;
	InRegs.x.dx=x_max;

	int86(0x33,&InRegs,&OutRegs);

	InRegs.x.ax=0x08;
	InRegs.x.cx=y_min;
	InRegs.x.dx=y_max;

	int86(0x33,&InRegs,&OutRegs);
    }

 /*************************************************************************/
 //------------------------  GetMouseCoordinates( )  ---------------------//
 /*************************************************************************/

 void GetMouseCoordinates(int *x,int *y)
    {
       InRegs.x.ax=0x03;
       int86(0x33,&InRegs,&OutRegs);

       *x=OutRegs.x.cx;
       *y=OutRegs.x.dx;
    }

    /****************************************************************************/
   void getmousepos(int *button,int*x,int*y)
   {
   InRegs.x.ax=3;
   int86(0x33,&InRegs,&OutRegs);
   *button=OutRegs.x.bx;
   *x=OutRegs.x.cx;
   *y=OutRegs.x.dx;
   }


   /**************************************************************************** /


 /*************************************************************************/
 //-------------------------  MouseKeyPressed( )  ------------------------//
 /*************************************************************************/

 const int MouseKeyPressed( )
    {
       InRegs.x.ax=0x05;
       InRegs.x.bx=0x00;

       int86(0x33,&InRegs,&OutRegs);

       int flag=0;

       if(OutRegs.x.ax==0x01)
	  flag=1;

       InRegs.x.bx=0x01;
       int86(0x33,&InRegs,&OutRegs);

       if(OutRegs.x.ax==0x02)
	  flag=2;

       InRegs.x.bx=0x02;
       int86(0x33,&InRegs,&OutRegs);

       return flag;
    }

 /*************************************************************************/
 //-----------------------  LeftMouseKeyPressed( )  ----------------------//
 /*************************************************************************/

 const int LeftMouseKeyPressed( )
    {
       int flag=MouseKeyPressed( );

       return ((flag==1)?1:0);
    }

 /*************************************************************************/
 //------------------------  RightMouseKeyPressed( )  --------------------//
 /*************************************************************************/

 const int RightMouseKeyPressed( )
    {
       int flag=MouseKeyPressed( );

       return ((flag==2)?1:0);
    }

 /*************************************************************************/
 //-----------------------------  MouseMove( )  --------------------------//
 /*************************************************************************/

 const int MouseMove( )
    {
       int flag=0;

       int x;
       int y;

       GetMouseCoordinates(&x,&y);

       if(x!=prev_mouse_x || y!=prev_mouse_y)
	  {
	     flag=1;

	     prev_mouse_x=x;
	     prev_mouse_y=y;
	  }

       return flag;
    }

 /*************************************************************************/
 /*************************************************************************/
 //-----------------------------  THE END  -------------------------------//
 /*************************************************************************/
 /*************************************************************************/

